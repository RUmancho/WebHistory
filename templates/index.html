<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</title>
    <link rel="icon" type="image/jpeg" href="/static/logo.jpg">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.9) 0%, rgba(22, 33, 62, 0.9) 50%, rgba(15, 52, 96, 0.9) 100%),
                        url('/static/h1.jpg') center/cover no-repeat fixed;
            min-height: 100vh;
            padding: 20px;
            color: #e8e8e8;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .school-logo {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .school-logo img {
            width: 120px;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.8em;
            font-weight: 700;
            background: linear-gradient(135deg, #e94560, #f39c12);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            text-shadow: 0 4px 30px rgba(233, 69, 96, 0.3);
        }
        
        .header .subtitle {
            color: #8892b0;
            font-size: 1.2em;
            font-weight: 400;
        }
        
        /* –°–µ–∫—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ */
        .auth-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            margin: 0 auto 40px auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .auth-section h2 {
            color: #e94560;
            margin-bottom: 25px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .auth-section h2::before {
            content: 'üîê';
            font-size: 1.2em;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #8892b0;
            font-size: 1em;
            font-weight: 500;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 16px;
            background: rgba(0, 0, 0, 0.3);
            color: #ffffff;
            cursor: pointer;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        .form-group input:-webkit-autofill,
        .form-group input:-webkit-autofill:hover,
        .form-group input:-webkit-autofill:focus {
            -webkit-text-fill-color: #ffffff;
            -webkit-box-shadow: 0 0 0px 1000px rgba(0, 0, 0, 0.3) inset;
            transition: background-color 5000s ease-in-out 0s;
        }
        
        .field-hint {
            margin-top: 8px;
            font-size: 0.95em;
            min-height: 20px;
            font-weight: 600;
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        .field-hint.error {
            color: #ffffff;
            background: rgba(255, 71, 87, 0.9);
        }
        
        .field-hint.success {
            color: #ffffff;
            background: rgba(46, 213, 115, 0.9);
        }
        
        .field-hint.info {
            color: #ffffff;
            background: rgba(116, 125, 140, 0.8);
        }
        
        .form-group input::placeholder {
            color: #7a8ab0;
            opacity: 1;
        }
        
        .form-row-inline {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .form-row-inline .form-group {
            flex: 1;
            margin-bottom: 0;
        }
        
        .form-group input:focus {
            border-color: #e94560;
            box-shadow: 0 0 0 4px rgba(233, 69, 96, 0.2);
            outline: none;
        }
        
        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, #e94560, #f39c12);
            color: white;
            border: none;
            padding: 16px;
            font-size: 1.1em;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(233, 69, 96, 0.3);
        }
        
        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(233, 69, 96, 0.4);
        }
        
        .submit-btn:active {
            transform: translateY(-1px);
        }
        
        .error-message {
            color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            padding: 12px 16px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
            animation: shake 0.5s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* –°–µ–∫—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
        .results-section {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        
        .class-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .class-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(233, 69, 96, 0.3);
        }
        
        .class-name {
            font-size: 1.6em;
            font-weight: 700;
            color: #e94560;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .class-name::before {
            content: 'üìö';
            font-size: 1em;
        }
        
        .student-count {
            background: linear-gradient(135deg, #e94560, #f39c12);
            color: white;
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 0.9em;
            font-weight: 600;
        }
        
        .results-table {
            width: 100%;
            border-collapse: collapse;
            overflow: hidden;
            border-radius: 12px;
        }
        
        .results-table thead {
            background: rgba(233, 69, 96, 0.2);
        }
        
        .results-table th {
            padding: 16px 20px;
            text-align: left;
            color: #e94560;
            font-weight: 600;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .results-table tbody tr.student-row {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .results-table tbody tr.student-row:hover {
            background: rgba(255, 255, 255, 0.08);
        }
        
        .results-table td {
            padding: 16px 20px;
            color: #e8e8e8;
            font-size: 1em;
        }
        
        .student-row td:first-child::before {
            content: 'üë§ ';
        }
        
        .expand-icon {
            display: inline-block;
            margin-left: 10px;
            transition: transform 0.3s ease;
            font-size: 0.8em;
        }
        
        .student-row.expanded .expand-icon {
            transform: rotate(180deg);
        }
        
        .score-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.95em;
        }
        
        .score-excellent {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }
        
        .score-good {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.3);
        }
        
        .score-average {
            background: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
            border: 1px solid rgba(241, 196, 15, 0.3);
        }
        
        .time-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 15px;
            font-weight: 500;
            font-size: 0.85em;
            background: rgba(155, 89, 182, 0.2);
            color: #9b59b6;
            border: 1px solid rgba(155, 89, 182, 0.3);
        }
        
        .selected-location {
            text-align: center;
            margin-bottom: 25px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(233, 69, 96, 0.15), rgba(243, 156, 18, 0.15));
            border-radius: 15px;
            border: 1px solid rgba(233, 69, 96, 0.3);
        }
        
        .selected-location h3 {
            color: #e94560;
            font-size: 1.4em;
            margin: 0;
        }
        
        .selected-location span {
            color: #f39c12;
        }
        
        .score-poor {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .level-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.85em;
            font-weight: 500;
            background: rgba(155, 89, 182, 0.2);
            color: #9b59b6;
            border: 1px solid rgba(155, 89, 182, 0.3);
        }
        
        /* –î–µ—Ç–∞–ª–∏ —É—á–µ–Ω–∏–∫–∞ */
        .student-details {
            display: none;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            margin: 10px 20px 20px 20px;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
        }
        
        .student-details.visible {
            display: block;
        }
        
        .details-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #8892b0;
            font-size: 0.95em;
        }
        
        .answers-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .answer-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 0.95em;
        }
        
        .answer-correct {
            background: rgba(46, 204, 113, 0.15);
            border: 1px solid rgba(46, 204, 113, 0.3);
        }
        
        .answer-incorrect {
            background: rgba(231, 76, 60, 0.15);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .answer-icon {
            font-size: 1.2em;
        }
        
        .answer-text {
            flex: 1;
        }
        
        .answer-text .question-num {
            color: #8892b0;
            font-weight: 600;
        }
        
        .answer-text .answer-value {
            margin-left: 8px;
        }
        
        .answer-correct .answer-value {
            color: #2ecc71;
        }
        
        .answer-incorrect .answer-value {
            color: #e74c3c;
        }
        
        .correct-answer-hint {
            font-size: 0.85em;
            color: #8892b0;
            margin-left: 5px;
        }
        
        .question-block {
            background: rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }
        
        .question-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .question-icon {
            font-size: 1.3em;
            flex-shrink: 0;
        }
        
        .question-content {
            flex: 1;
        }
        
        .question-title {
            color: #e94560;
            font-weight: 600;
            font-size: 0.9em;
            margin-bottom: 6px;
        }
        
        .question-text-full {
            color: #e8e8e8;
            font-size: 1em;
            line-height: 1.5;
            margin-bottom: 10px;
        }
        
        .answer-info {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            font-size: 0.9em;
        }
        
        .answer-label {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 8px;
        }
        
        .answer-label.user-answer {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .answer-label.correct-answer {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }
        
        .answer-label.wrong-answer {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }
        
        .question-block.correct-block {
            border-left: 4px solid #2ecc71;
        }
        
        .question-block.incorrect-block {
            border-left: 4px solid #e74c3c;
        }
        
        /* –°–µ–∫—Ü–∏—è —Ç–µ—Å—Ç–∞ –≤ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è—Ö —É—á–µ–Ω–∏–∫–∞ */
        .test-section {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
        }
        
        .test-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .test-header {
            color: #f39c12;
            font-size: 1.1em;
            margin-bottom: 15px;
            padding: 10px 15px;
            background: rgba(243, 156, 18, 0.1);
            border-radius: 8px;
            border-left: 3px solid #f39c12;
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º */
        .questions-stats-section {
            margin-top: 30px;
        }
        
        .questions-stats-title {
            color: #e8e8e8;
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-level-group {
            background: rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-level-title {
            color: #9b59b6;
            font-size: 1em;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(155, 89, 182, 0.3);
        }
        
        .question-stat-item {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 12px;
        }
        
        .question-stat-item:last-child {
            margin-bottom: 0;
        }
        
        .question-stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }
        
        .question-stat-text {
            flex: 1;
            color: #e8e8e8;
            font-size: 0.95em;
            line-height: 1.4;
            padding-right: 15px;
        }
        
        .question-stat-number {
            color: #e94560;
            font-weight: 600;
            margin-right: 8px;
        }
        
        .question-stat-respondents {
            color: #8892b0;
            font-size: 0.85em;
            white-space: nowrap;
        }
        
        .question-stat-bar-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .question-stat-bar {
            flex: 1;
            height: 24px;
            background: rgba(231, 76, 60, 0.3);
            border-radius: 12px;
            overflow: hidden;
            display: flex;
        }
        
        .question-stat-bar-correct {
            height: 100%;
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8em;
            font-weight: 600;
            min-width: 40px;
            transition: width 0.5s ease;
        }
        
        .question-stat-bar-incorrect {
            height: 100%;
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8em;
            font-weight: 600;
            min-width: 40px;
            flex: 1;
        }
        
        .question-stat-bar-correct:empty,
        .question-stat-bar-incorrect:empty {
            min-width: 0;
        }
        
        .question-stat-legend {
            display: flex;
            gap: 15px;
            margin-top: 8px;
            font-size: 0.85em;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .legend-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        
        .legend-dot.correct {
            background: #2ecc71;
        }
        
        .legend-dot.incorrect {
            background: #e74c3c;
        }
        
        .legend-text {
            color: #8892b0;
        }
        
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #8892b0;
            font-size: 1.2em;
        }
        
        .no-results::before {
            content: 'üìã';
            display: block;
            font-size: 3em;
            margin-bottom: 20px;
        }
        
        .logout-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #8892b0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }
        
        .logout-btn:hover {
            background: rgba(233, 69, 96, 0.2);
            color: #e94560;
            border-color: rgba(233, 69, 96, 0.3);
        }
        
        .refresh-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid rgba(46, 204, 113, 0.3);
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .refresh-btn:hover {
            background: rgba(46, 204, 113, 0.3);
            transform: scale(1.05);
        }
        
        .refresh-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .auto-refresh-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #2ecc71;
            font-size: 0.9em;
            padding: 8px 16px;
            background: rgba(46, 204, 113, 0.1);
            border-radius: 20px;
            border: 1px solid rgba(46, 204, 113, 0.2);
        }
        
        .pulse-dot {
            width: 10px;
            height: 10px;
            background: #2ecc71;
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.8); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(100px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .stats-bar {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        
        .stat-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px 30px;
            text-align: center;
            flex: 1;
            min-width: 150px;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: 700;
            color: #e94560;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #8892b0;
            font-size: 0.9em;
        }
        
        /* –°–µ–∫—Ü–∏—è –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
        .global-stats-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin-top: 40px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }
        
        .global-stats-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(233, 69, 96, 0.3);
        }
        
        .global-stats-header h2 {
            font-size: 1.5em;
            font-weight: 700;
            color: #e94560;
        }
        
        .global-stats-header::before {
            content: 'üìä';
            font-size: 1.5em;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stats-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
        }
        
        .stats-card-value {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .stats-card-value.excellent {
            color: #2ecc71;
        }
        
        .stats-card-value.good {
            color: #3498db;
        }
        
        .stats-card-value.average {
            color: #f1c40f;
        }
        
        .stats-card-value.poor {
            color: #e74c3c;
        }
        
        .stats-card-value.neutral {
            color: #e94560;
        }
        
        .stats-card-label {
            color: #8892b0;
            font-size: 1em;
        }
        
        .level-stats {
            margin-top: 20px;
        }
        
        .level-stats-title {
            color: #e8e8e8;
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .level-stat-row {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.15);
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .level-stat-name {
            min-width: 150px;
            color: #9b59b6;
            font-weight: 600;
        }
        
        .level-stat-bar {
            flex: 1;
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            overflow: hidden;
        }
        
        .level-stat-fill {
            height: 100%;
            border-radius: 6px;
            transition: width 0.5s ease;
        }
        
        .level-stat-value {
            min-width: 80px;
            text-align: right;
            font-weight: 600;
        }
        
        .click-hint {
            text-align: center;
            color: #5a6a8a;
            font-size: 0.9em;
            margin-top: 15px;
            font-style: italic;
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –∫–ª–∞—Å—Å–∞ */
        .class-stats-section {
            margin-top: 25px;
            padding-top: 25px;
            border-top: 2px dashed rgba(255, 255, 255, 0.1);
        }
        
        .class-stats-header {
            cursor: pointer;
            user-select: none;
            transition: all 0.3s ease;
        }
        
        .class-stats-header:hover {
            opacity: 0.85;
        }
        
        .class-stats-header h3 {
            color: #e94560;
            font-size: 1.3em;
            margin-bottom: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .class-stats-toggle {
            display: inline-block;
            transition: transform 0.3s ease;
            font-size: 0.8em;
        }
        
        .class-stats-section.collapsed .class-stats-toggle {
            transform: rotate(-90deg);
        }
        
        .class-stats-content {
            max-height: 2000px;
            overflow: hidden;
            transition: max-height 0.4s ease-out, opacity 0.3s ease;
            opacity: 1;
        }
        
        .class-stats-section.collapsed .class-stats-content {
            max-height: 0;
            opacity: 0;
        }
        
        .class-questions-stats {
            margin-bottom: 20px;
        }
        
        .class-stats-title {
            color: #e8e8e8;
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            padding-left: 5px;
        }
        
        .class-test-group {
            background: rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .class-question-stat {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
        }
        
        .class-question-stat .question-stat-text {
            font-size: 0.95em;
        }
        
        .global-stats-hint {
            text-align: center;
            margin-top: 25px;
            padding: 15px;
            background: rgba(233, 69, 96, 0.1);
            border-radius: 10px;
            border: 1px dashed rgba(233, 69, 96, 0.3);
        }
        
        .global-stats-hint p {
            color: #8892b0;
            font-size: 1em;
            margin: 0;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .auth-section, .class-card, .global-stats-section {
                padding: 25px;
            }
            
            .results-table th, .results-table td {
                padding: 12px 10px;
                font-size: 0.9em;
            }
            
            .class-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .answers-list {
                gap: 10px;
            }
            
            .question-block {
                padding: 12px;
            }
            
            .answer-info {
                flex-direction: column;
                gap: 8px;
            }
            
            .student-details {
                margin: 10px 10px 20px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="school-logo">
            <img src="/static/logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø —à–∫–æ–ª—ã">
        </div>
        
        <div class="header">
            <h1>–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã</h1>
            <p class="subtitle">–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É—á–µ–Ω–∏–∫–æ–≤</p>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
        <div class="auth-section" id="authSection">
            <h2>–î–æ—Å—Ç—É–ø –¥–ª—è —É—á–∏—Ç–µ–ª—è</h2>
            <form id="authForm">
                <div class="form-row-inline">
                    <div class="form-group">
                        <label for="regionInput">–ö–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞</label>
                        <input type="number" id="regionInput" name="regionInput" required 
                               placeholder="52" min="1" max="99">
                    </div>
                    <div class="form-group" style="flex: 2;">
                        <label for="cityInput">–ì–æ—Ä–æ–¥</label>
                        <select id="cityInput" name="cityInput" required disabled>
                            <option value="">-- –°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω --</option>
                        </select>
                    </div>
                </div>
                <div class="field-hint" id="cityHint"></div>
                <div class="form-group">
                    <label for="schoolInput">–ù–æ–º–µ—Ä —à–∫–æ–ª—ã</label>
                    <input type="number" id="schoolInput" name="schoolInput" required 
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —à–∫–æ–ª—ã..." min="1" max="9999">
                    <div class="field-hint" id="schoolHint"></div>
                </div>
                <div class="form-group">
                    <label for="teacherKey">–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞</label>
                    <input type="password" id="teacherKey" name="teacherKey" required 
                           placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á...">
                </div>
                <button type="submit" class="submit-btn">–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
                <div class="error-message" id="errorMessage"></div>
            </form>
        </div>
        
        <!-- –°–µ–∫—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
        <div class="results-section" id="resultsSection">
            <div class="selected-location" id="selectedLocation">
                <!-- –ì–æ—Ä–æ–¥ –∏ —à–∫–æ–ª–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            
            <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap; margin-bottom: 30px;">
                <button class="logout-btn" onclick="logout()" style="margin-bottom: 0;">
                    <span>üîí</span> –í—ã–π—Ç–∏
                </button>
                <button class="refresh-btn" onclick="manualRefresh()" id="refreshBtn">
                    <span>üîÑ</span> –û–±–Ω–æ–≤–∏—Ç—å
                </button>
                <div class="auto-refresh-indicator" id="autoRefreshIndicator">
                    <span class="pulse-dot"></span>
                    <span>–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ</span>
                </div>
            </div>
            
            <div class="stats-bar" id="statsBar">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            
            <div id="classesContainer">
                <!-- –¢–∞–±–ª–∏—Ü—ã –ø–æ –∫–ª–∞—Å—Å–∞–º –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
            
            <!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="global-stats-section" id="globalStatsSection">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>
    </div>

    <script>
        let allData = null;
        
        // –ë–∞–∑–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
        const QUESTIONS_DB = {
            // 9-11 –∫–ª–∞—Å—Å - –õ—ë–≥–∫–∏–π
            '4_easy': {
                1: '–ö–∞–∫ –∑–≤–∞–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ –∏–º–ø–µ—Ä–∞—Ç–æ—Ä–∞?',
                2: '–ö–∞–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ 7 –Ω–æ—è–±—Ä—è 1917 –≥–æ–¥–∞ (–ø–æ —Å—Ç–∞—Ä–æ–º—É —Å—Ç–∏–ª—é)?',
                3: '–ö—Ç–æ –±—ã–ª –í–µ—Ä—Ö–æ–≤–Ω—ã–º –ì–ª–∞–≤–Ω–æ–∫–æ–º–∞–Ω–¥—É—é—â–∏–º –°–°–°–† –≤ –≥–æ–¥—ã –í–µ–ª–∏–∫–æ–π –û—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –≤–æ–π–Ω—ã?',
                4: '–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–ª–∞—Å—å –ø–æ–ª–∏—Ç–∏–∫–∞ —Ä–∞–¥–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—Ñ–æ—Ä–º –ú.–°. –ì–æ—Ä–±–∞—á—ë–≤–∞?'
            },
            // 9-11 –∫–ª–∞—Å—Å - –°—Ä–µ–¥–Ω–∏–π
            '4_medium': {
                1: '–ß—Ç–æ —Ç–∞–∫–æ–µ "—Ö–æ–ª–æ–¥–Ω–∞—è –≤–æ–π–Ω–∞"?',
                2: '–í —á—ë–º —Å—É—Ç—å –∫–æ–ª–ª–µ–∫—Ç–∏–≤–∏–∑–∞—Ü–∏–∏ –≤ –°–°–°–†?',
                3: '–ß—Ç–æ —Ç–∞–∫–æ–µ "–ª–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–µ –¥–µ–ª–æ"?',
                4: '–ö–∞–∫–æ–≤—ã –±—ã–ª–∏ –≥–ª–∞–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –§–µ–≤—Ä–∞–ª—å—Å–∫–æ–π —Ä–µ–≤–æ–ª—é—Ü–∏–∏ 1917 –≥–æ–¥–∞?'
            },
            // 9-11 –∫–ª–∞—Å—Å - –°–ª–æ–∂–Ω—ã–π
            '4_hard': {
                1: '–ö–∞–∫–æ–≤—ã –±—ã–ª–∏ –≥–ª–∞–≤–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –ë—Ä–µ—Å—Ç—Å–∫–æ–≥–æ –º–∏—Ä–∞ 1918 –≥–æ–¥–∞ –¥–ª—è –†–æ—Å—Å–∏–∏?',
                2: '–í —á—ë–º –∑–∞–∫–ª—é—á–∞–ª–∞—Å—å —Å—É—Ç—å "—à–æ–∫–æ–≤–æ–π —Ç–µ—Ä–∞–ø–∏–∏" –≤ —ç–∫–æ–Ω–æ–º–∏–∫–µ –†–æ—Å—Å–∏–∏ 1990-—Ö –≥–æ–¥–æ–≤?',
                3: '–ß—Ç–æ —Ç–∞–∫–æ–µ "–¥–∏—Å—Å–∏–¥–µ–Ω—Ç—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ" –≤ –°–°–°–†?',
                4: '–ö–∞–∫–æ–≤—ã –±—ã–ª–∏ –≥–ª–∞–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –ö–∞—Ä–∏–±—Å–∫–æ–≥–æ –∫—Ä–∏–∑–∏—Å–∞ 1962 –≥–æ–¥–∞?'
            },
            // 7-8 –∫–ª–∞—Å—Å - –õ—ë–≥–∫–∏–π
            '3_easy': {
                1: '–ö–∞–∫–æ–π —Ä—É—Å—Å–∫–∏–π —Ü–∞—Ä—å –ø—Ä–æ—Ä—É–±–∏–ª "–æ–∫–Ω–æ –≤ –ï–≤—Ä–æ–ø—É"?',
                2: '–ö—Ç–æ –±—ã–ª –≥–ª–∞–≤–Ω–æ–∫–æ–º–∞–Ω–¥—É—é—â–∏–º —Ä—É—Å—Å–∫–æ–π –∞—Ä–º–∏–µ–π –≤ 1812 –≥–æ–¥—É?',
                3: '–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–ª–∞—Å—å –≤–æ–π–Ω–∞ 1812 –≥–æ–¥–∞?',
                4: '–ö—Ç–æ —Ç–∞–∫–∞—è –ï–∫–∞—Ç–µ—Ä–∏–Ω–∞ II?'
            },
            // 7-8 –∫–ª–∞—Å—Å - –°—Ä–µ–¥–Ω–∏–π
            '3_medium': {
                1: '–ü–æ—á–µ–º—É –≤–æ–π–Ω–∞ 1812 –≥–æ–¥–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –û—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π?',
                2: '–í —á—ë–º –≥–ª–∞–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –æ—Ç–º–µ–Ω—ã –∫—Ä–µ–ø–æ—Å—Ç–Ω–æ–≥–æ –ø—Ä–∞–≤–∞ –≤ 1861 –≥–æ–¥—É?',
                3: '–ß—Ç–æ —Ç–∞–∫–æ–µ "–°–µ–≤–µ—Ä–Ω–∞—è –≤–æ–π–Ω–∞" –∏ —Å –∫–µ–º –æ–Ω–∞ –≤–µ–ª–∞—Å—å?',
                4: '–ö—Ç–æ —Ç–∞–∫–∏–µ "–¥–µ–∫–∞–±—Ä–∏—Å—Ç—ã"?'
            },
            // 7-8 –∫–ª–∞—Å—Å - –°–ª–æ–∂–Ω—ã–π
            '3_hard': {
                1: '–ß—Ç–æ —Ç–∞–∫–æ–µ "–≤–æ–µ–Ω–Ω—ã–µ –ø–æ—Å–µ–ª–µ–Ω–∏—è" –ø—Ä–∏ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–µ I?',
                2: '–í —á—ë–º —Å—É—Ç—å "–ü—Ä–æ—Å–≤–µ—â—ë–Ω–Ω–æ–≥–æ –∞–±—Å–æ–ª—é—Ç–∏–∑–º–∞" –ï–∫–∞—Ç–µ—Ä–∏–Ω—ã II?',
                3: '–ö–∞–∫–æ–≤—ã –±—ã–ª–∏ –≥–ª–∞–≤–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è –¶–µ—Ä–∫–æ–≤–Ω–æ–≥–æ —Ä–∞—Å–∫–æ–ª–∞ XVII –≤–µ–∫–∞?',
                4: '–ß—Ç–æ —Ç–∞–∫–æ–µ "–±–∏—Ä–æ–Ω–æ–≤—â–∏–Ω–∞"?'
            }
        };
        
        function getQuestionText(level, questionNum) {
            if (QUESTIONS_DB[level] && QUESTIONS_DB[level][questionNum]) {
                return QUESTIONS_DB[level][questionNum];
            }
            return `–í–æ–ø—Ä–æ—Å ${questionNum}`;
        }
        
        function formatTime(seconds) {
            if (!seconds || seconds <= 0) return '‚Äî';
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            if (mins === 0) return `${secs}—Å`;
            return `${mins}–º ${secs}—Å`;
        }
        
        let selectedCity = '';
        let selectedSchool = '';
        let cityValid = false;
        let schoolValid = false;
        
        // –î–∞–Ω–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ –≥–æ—Ä–æ–¥–æ–≤ –†–æ—Å—Å–∏–∏
        const REGIONS_DATA = {
            1: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ê–¥—ã–≥–µ—è', cities: ['–ú–∞–π–∫–æ–ø', '–ê–¥—ã–≥–µ–π—Å–∫'] },
            2: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω', cities: ['–£—Ñ–∞', '–°—Ç–µ—Ä–ª–∏—Ç–∞–º–∞–∫', '–°–∞–ª–∞–≤–∞—Ç', '–ù–µ—Ñ—Ç–µ–∫–∞–º—Å–∫', '–û–∫—Ç—è–±—Ä—å—Å–∫–∏–π'] },
            3: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ë—É—Ä—è—Ç–∏—è', cities: ['–£–ª–∞–Ω-–£–¥—ç', '–°–µ–≤–µ—Ä–æ–±–∞–π–∫–∞–ª—å—Å–∫', '–ì—É—Å–∏–Ω–æ–æ–∑—ë—Ä—Å–∫'] },
            4: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ê–ª—Ç–∞–π', cities: ['–ì–æ—Ä–Ω–æ-–ê–ª—Ç–∞–π—Å–∫'] },
            5: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –î–∞–≥–µ—Å—Ç–∞–Ω', cities: ['–ú–∞—Ö–∞—á–∫–∞–ª–∞', '–•–∞—Å–∞–≤—é—Ä—Ç', '–î–µ—Ä–±–µ–Ω—Ç', '–ö–∞—Å–ø–∏–π—Å–∫', '–ë—É–π–Ω–∞–∫—Å–∫'] },
            6: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ò–Ω–≥—É—à–µ—Ç–∏—è', cities: ['–ú–∞–≥–∞—Å', '–ù–∞–∑—Ä–∞–Ω—å', '–ö–∞—Ä–∞–±—É–ª–∞–∫', '–ú–∞–ª–≥–æ–±–µ–∫'] },
            7: { name: '–ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞', cities: ['–ù–∞–ª—å—á–∏–∫', '–ü—Ä–æ—Ö–ª–∞–¥–Ω—ã–π', '–ë–∞–∫—Å–∞–Ω'] },
            8: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞–ª–º—ã–∫–∏—è', cities: ['–≠–ª–∏—Å—Ç–∞', '–õ–∞–≥–∞–Ω—å', '–ì–æ—Ä–æ–¥–æ–≤–∏–∫–æ–≤—Å–∫'] },
            9: { name: '–ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞', cities: ['–ß–µ—Ä–∫–µ—Å—Å–∫', '–ö–∞—Ä–∞—á–∞–µ–≤—Å–∫', '–£—Å—Ç—å-–î–∂–µ–≥—É—Ç–∞'] },
            10: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–∞—Ä–µ–ª–∏—è', cities: ['–ü–µ—Ç—Ä–æ–∑–∞–≤–æ–¥—Å–∫', '–ö–æ–Ω–¥–æ–ø–æ–≥–∞', '–°–µ–≥–µ–∂–∞', '–ö–æ—Å—Ç–æ–º—É–∫—à–∞'] },
            11: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö–æ–º–∏', cities: ['–°—ã–∫—Ç—ã–≤–∫–∞—Ä', '–£—Ö—Ç–∞', '–í–æ—Ä–∫—É—Ç–∞', '–ü–µ—á–æ—Ä–∞', '–£—Å–∏–Ω—Å–∫'] },
            12: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–∞—Ä–∏–π –≠–ª', cities: ['–ô–æ—à–∫–∞—Ä-–û–ª–∞', '–í–æ–ª–∂—Å–∫', '–ö–æ–∑—å–º–æ–¥–µ–º—å—è–Ω—Å–∫'] },
            13: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ú–æ—Ä–¥–æ–≤–∏—è', cities: ['–°–∞—Ä–∞–Ω—Å–∫', '–†—É–∑–∞–µ–≤–∫–∞', '–ö–æ–≤—ã–ª–∫–∏–Ω–æ'] },
            14: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è)', cities: ['–Ø–∫—É—Ç—Å–∫', '–ù–µ—Ä—é–Ω–≥—Ä–∏', '–ú–∏—Ä–Ω—ã–π', '–ê–ª–¥–∞–Ω'] },
            15: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –°–µ–≤–µ—Ä–Ω–∞—è –û—Å–µ—Ç–∏—è', cities: ['–í–ª–∞–¥–∏–∫–∞–≤–∫–∞–∑', '–ú–æ–∑–¥–æ–∫', '–ë–µ—Å–ª–∞–Ω'] },
            16: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω', cities: ['–ö–∞–∑–∞–Ω—å', '–ù–∞–±–µ—Ä–µ–∂–Ω—ã–µ –ß–µ–ª–Ω—ã', '–ù–∏–∂–Ω–µ–∫–∞–º—Å–∫', '–ê–ª—å–º–µ—Ç—å–µ–≤—Å–∫', '–ó–µ–ª–µ–Ω–æ–¥–æ–ª—å—Å–∫'] },
            17: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –¢—ã–≤–∞', cities: ['–ö—ã–∑—ã–ª', '–ê–∫-–î–æ–≤—É—Ä–∞–∫'] },
            18: { name: '–£–¥–º—É—Ä—Ç—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞', cities: ['–ò–∂–µ–≤—Å–∫', '–°–∞—Ä–∞–ø—É–ª', '–í–æ—Ç–∫–∏–Ω—Å–∫', '–ì–ª–∞–∑–æ–≤'] },
            19: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –•–∞–∫–∞—Å–∏—è', cities: ['–ê–±–∞–∫–∞–Ω', '–ß–µ—Ä–Ω–æ–≥–æ—Ä—Å–∫', '–°–∞—è–Ω–æ–≥–æ—Ä—Å–∫'] },
            20: { name: '–ß–µ—á–µ–Ω—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞', cities: ['–ì—Ä–æ–∑–Ω—ã–π', '–£—Ä—É—Å-–ú–∞—Ä—Ç–∞–Ω', '–®–∞–ª–∏', '–ì—É–¥–µ—Ä–º–µ—Å'] },
            21: { name: '–ß—É–≤–∞—à—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞', cities: ['–ß–µ–±–æ–∫—Å–∞—Ä—ã', '–ù–æ–≤–æ—á–µ–±–æ–∫—Å–∞—Ä—Å–∫', '–ö–∞–Ω–∞—à', '–ê–ª–∞—Ç—ã—Ä—å'] },
            22: { name: '–ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π', cities: ['–ë–∞—Ä–Ω–∞—É–ª', '–ë–∏–π—Å–∫', '–†—É–±—Ü–æ–≤—Å–∫', '–ù–æ–≤–æ–∞–ª—Ç–∞–π—Å–∫', '–ó–∞—Ä–∏–Ω—Å–∫'] },
            23: { name: '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π', cities: ['–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä', '–°–æ—á–∏', '–ù–æ–≤–æ—Ä–æ—Å—Å–∏–π—Å–∫', '–ê—Ä–º–∞–≤–∏—Ä', '–ï–π—Å–∫', '–ê–Ω–∞–ø–∞', '–ì–µ–ª–µ–Ω–¥–∂–∏–∫'] },
            24: { name: '–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π', cities: ['–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫', '–ù–æ—Ä–∏–ª—å—Å–∫', '–ê—á–∏–Ω—Å–∫', '–ö–∞–Ω—Å–∫', '–ñ–µ–ª–µ–∑–Ω–æ–≥–æ—Ä—Å–∫', '–ú–∏–Ω—É—Å–∏–Ω—Å–∫'] },
            25: { name: '–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π –∫—Ä–∞–π', cities: ['–í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫', '–£—Å—Å—É—Ä–∏–π—Å–∫', '–ù–∞—Ö–æ–¥–∫–∞', '–ê—Ä—Ç—ë–º', '–ê—Ä—Å–µ–Ω—å–µ–≤'] },
            26: { name: '–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π', cities: ['–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å', '–ü—è—Ç–∏–≥–æ—Ä—Å–∫', '–ö–∏—Å–ª–æ–≤–æ–¥—Å–∫', '–ù–µ–≤–∏–Ω–Ω–æ–º—ã—Å—Å–∫', '–ï—Å—Å–µ–Ω—Ç—É–∫–∏', '–ú–∏–Ω–µ—Ä–∞–ª—å–Ω—ã–µ –í–æ–¥—ã'] },
            27: { name: '–•–∞–±–∞—Ä–æ–≤—Å–∫–∏–π –∫—Ä–∞–π', cities: ['–•–∞–±–∞—Ä–æ–≤—Å–∫', '–ö–æ–º—Å–æ–º–æ–ª—å—Å–∫-–Ω–∞-–ê–º—É—Ä–µ', '–ê–º—É—Ä—Å–∫', '–°–æ–≤–µ—Ç—Å–∫–∞—è –ì–∞–≤–∞–Ω—å'] },
            28: { name: '–ê–º—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ë–ª–∞–≥–æ–≤–µ—â–µ–Ω—Å–∫', '–ë–µ–ª–æ–≥–æ—Ä—Å–∫', '–°–≤–æ–±–æ–¥–Ω—ã–π', '–¢—ã–Ω–¥–∞'] },
            29: { name: '–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫', '–°–µ–≤–µ—Ä–æ–¥–≤–∏–Ω—Å–∫', '–ö–æ—Ç–ª–∞—Å', '–ù–æ–≤–æ–¥–≤–∏–Ω—Å–∫'] },
            30: { name: '–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ê—Å—Ç—Ä–∞—Ö–∞–Ω—å', '–ê—Ö—Ç—É–±–∏–Ω—Å–∫', '–ó–Ω–∞–º–µ–Ω—Å–∫', '–•–∞—Ä–∞–±–∞–ª–∏'] },
            31: { name: '–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ë–µ–ª–≥–æ—Ä–æ–¥', '–°—Ç–∞—Ä—ã–π –û—Å–∫–æ–ª', '–ì—É–±–∫–∏–Ω', '–®–µ–±–µ–∫–∏–Ω–æ', '–ê–ª–µ–∫—Å–µ–µ–≤–∫–∞'] },
            32: { name: '–ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ë—Ä—è–Ω—Å–∫', '–ö–ª–∏–Ω—Ü—ã', '–ù–æ–≤–æ–∑—ã–±–∫–æ–≤', '–î—è—Ç—å–∫–æ–≤–æ'] },
            33: { name: '–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–í–ª–∞–¥–∏–º–∏—Ä', '–ö–æ–≤—Ä–æ–≤', '–ú—É—Ä–æ–º', '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤', '–ì—É—Å—å-–•—Ä—É—Å—Ç–∞–ª—å–Ω—ã–π'] },
            34: { name: '–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–í–æ–ª–≥–æ–≥—Ä–∞–¥', '–í–æ–ª–∂—Å–∫–∏–π', '–ö–∞–º—ã—à–∏–Ω', '–ú–∏—Ö–∞–π–ª–æ–≤–∫–∞', '–£—Ä—é–ø–∏–Ω—Å–∫'] },
            35: { name: '–í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–í–æ–ª–æ–≥–¥–∞', '–ß–µ—Ä–µ–ø–æ–≤–µ—Ü', '–°–æ–∫–æ–ª', '–í–µ–ª–∏–∫–∏–π –£—Å—Ç—é–≥'] },
            36: { name: '–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–í–æ—Ä–æ–Ω–µ–∂', '–ë–æ—Ä–∏—Å–æ–≥–ª–µ–±—Å–∫', '–†–æ—Å—Å–æ—à—å', '–õ–∏—Å–∫–∏', '–û—Å—Ç—Ä–æ–≥–æ–∂—Å–∫'] },
            37: { name: '–ò–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ò–≤–∞–Ω–æ–≤–æ', '–ö–∏–Ω–µ—à–º–∞', '–®—É—è', '–í–∏—á—É–≥–∞', '–§—É—Ä–º–∞–Ω–æ–≤'] },
            38: { name: '–ò—Ä–∫—É—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ò—Ä–∫—É—Ç—Å–∫', '–ë—Ä–∞—Ç—Å–∫', '–ê–Ω–≥–∞—Ä—Å–∫', '–£—Å—Ç—å-–ò–ª–∏–º—Å–∫', '–£—Å–æ–ª—å–µ-–°–∏–±–∏—Ä—Å–∫–æ–µ'] },
            39: { name: '–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥', '–°–æ–≤–µ—Ç—Å–∫', '–ß–µ—Ä–Ω—è—Ö–æ–≤—Å–∫', '–ë–∞–ª—Ç–∏–π—Å–∫', '–ì—É—Å–µ–≤'] },
            40: { name: '–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ö–∞–ª—É–≥–∞', '–û–±–Ω–∏–Ω—Å–∫', '–õ—é–¥–∏–Ω–æ–≤–æ', '–ö–∏—Ä–æ–≤', '–ú–∞–ª–æ—è—Ä–æ—Å–ª–∞–≤–µ—Ü'] },
            41: { name: '–ö–∞–º—á–∞—Ç—Å–∫–∏–π –∫—Ä–∞–π', cities: ['–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫-–ö–∞–º—á–∞—Ç—Å–∫–∏–π', '–ï–ª–∏–∑–æ–≤–æ', '–í–∏–ª—é—á–∏–Ω—Å–∫'] },
            42: { name: '–ö–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ö–µ–º–µ—Ä–æ–≤–æ', '–ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫', '–ü—Ä–æ–∫–æ–ø—å–µ–≤—Å–∫', '–ú–µ–∂–¥—É—Ä–µ—á–µ–Ω—Å–∫', '–õ–µ–Ω–∏–Ω—Å–∫-–ö—É–∑–Ω–µ—Ü–∫–∏–π'] },
            43: { name: '–ö–∏—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ö–∏—Ä–æ–≤', '–ö–∏—Ä–æ–≤–æ-–ß–µ–ø–µ—Ü–∫', '–í—è—Ç—Å–∫–∏–µ –ü–æ–ª—è–Ω—ã', '–°–ª–æ–±–æ–¥—Å–∫–æ–π'] },
            44: { name: '–ö–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ö–æ—Å—Ç—Ä–æ–º–∞', '–ë—É–π', '–®–∞—Ä—å—è', '–ù–µ—Ä–µ—Ö—Ç–∞', '–ú–∞–Ω—Ç—É—Ä–æ–≤–æ'] },
            45: { name: '–ö—É—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ö—É—Ä–≥–∞–Ω', '–®–∞–¥—Ä–∏–Ω—Å–∫', '–®—É–º–∏—Ö–∞', '–î–∞–ª–º–∞—Ç–æ–≤–æ'] },
            46: { name: '–ö—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ö—É—Ä—Å–∫', '–ñ–µ–ª–µ–∑–Ω–æ–≥–æ—Ä—Å–∫', '–ö—É—Ä—á–∞—Ç–æ–≤', '–õ—å–≥–æ–≤', '–©–∏–≥—Ä—ã'] },
            47: { name: '–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ì–∞—Ç—á–∏–Ω–∞', '–í—ã–±–æ—Ä–≥', '–°–æ—Å–Ω–æ–≤—ã–π –ë–æ—Ä', '–í—Å–µ–≤–æ–ª–æ–∂—Å–∫', '–¢–∏—Ö–≤–∏–Ω', '–ö–∏—Ä–∏—à–∏'] },
            48: { name: '–õ–∏–ø–µ—Ü–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–õ–∏–ø–µ—Ü–∫', '–ï–ª–µ—Ü', '–ì—Ä—è–∑–∏', '–î–∞–Ω–∫–æ–≤', '–õ–µ–±–µ–¥—è–Ω—å'] },
            49: { name: '–ú–∞–≥–∞–¥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ú–∞–≥–∞–¥–∞–Ω', '–°—É—Å—É–º–∞–Ω', '–Ø–≥–æ–¥–Ω–æ–µ'] },
            50: { name: '–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ë–∞–ª–∞—à–∏—Ö–∞', '–ü–æ–¥–æ–ª—å—Å–∫', '–•–∏–º–∫–∏', '–ú—ã—Ç–∏—â–∏', '–ö–æ—Ä–æ–ª—ë–≤', '–õ—é–±–µ—Ä—Ü—ã', '–ö—Ä–∞—Å–Ω–æ–≥–æ—Ä—Å–∫', '–û–¥–∏–Ω—Ü–æ–≤–æ', '–î–æ–º–æ–¥–µ–¥–æ–≤–æ', '–©—ë–ª–∫–æ–≤–æ', '–°–µ—Ä–ø—É—Ö–æ–≤', '–û—Ä–µ—Ö–æ–≤–æ-–ó—É–µ–≤–æ', '–†–∞–º–µ–Ω—Å–∫–æ–µ', '–î–æ–ª–≥–æ–ø—Ä—É–¥–Ω—ã–π', '–ñ—É–∫–æ–≤—Å–∫–∏–π', '–ü—É—à–∫–∏–Ω–æ', '–†–µ—É—Ç–æ–≤', '–°–µ—Ä–≥–∏–µ–≤ –ü–æ—Å–∞–¥', '–ù–æ–≥–∏–Ω—Å–∫', '–ö–æ–ª–æ–º–Ω–∞'] },
            51: { name: '–ú—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ú—É—Ä–º–∞–Ω—Å–∫', '–ê–ø–∞—Ç–∏—Ç—ã', '–°–µ–≤–µ—Ä–æ–º–æ—Ä—Å–∫', '–ú–æ–Ω—á–µ–≥–æ—Ä—Å–∫', '–ö–∞–Ω–¥–∞–ª–∞–∫—à–∞'] },
            52: { name: '–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥', '–î–∑–µ—Ä–∂–∏–Ω—Å–∫', '–ê—Ä–∑–∞–º–∞—Å', '–°–∞—Ä–æ–≤', '–ë–æ—Ä', '–ö—Å—Ç–æ–≤–æ', '–ü–∞–≤–ª–æ–≤–æ', '–í—ã–∫—Å–∞', '–ë–∞–ª–∞—Ö–Ω–∞', '–ó–∞–≤–æ–ª–∂—å–µ', '–ì–æ—Ä–æ–¥–µ—Ü', '–ö—É–ª–µ–±–∞–∫–∏', '–ë–æ–≥–æ—Ä–æ–¥—Å–∫', '–°–µ–º—ë–Ω–æ–≤', '–õ—ã—Å–∫–æ–≤–æ'] },
            53: { name: '–ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–í–µ–ª–∏–∫–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥', '–ë–æ—Ä–æ–≤–∏—á–∏', '–°—Ç–∞—Ä–∞—è –†—É—Å—Å–∞', '–í–∞–ª–¥–∞–π'] },
            54: { name: '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', '–ë–µ—Ä–¥—Å–∫', '–ò—Å–∫–∏—Ç–∏–º', '–ö—É–π–±—ã—à–µ–≤', '–û–±—å', '–ë–∞—Ä–∞–±–∏–Ω—Å–∫'] },
            55: { name: '–û–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–û–º—Å–∫', '–ò—Å–∏–ª—å–∫—É–ª—å', '–ö–∞–ª–∞—á–∏–Ω—Å–∫', '–¢–∞—Ä–∞', '–¢—é–∫–∞–ª–∏–Ω—Å–∫'] },
            56: { name: '–û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–û—Ä–µ–Ω–±—É—Ä–≥', '–û—Ä—Å–∫', '–ù–æ–≤–æ—Ç—Ä–æ–∏—Ü–∫', '–ë—É–∑—É–ª—É–∫', '–ë—É–≥—É—Ä—É—Å–ª–∞–Ω', '–ì–∞–π'] },
            57: { name: '–û—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–û—Ä—ë–ª', '–õ–∏–≤–Ω—ã', '–ú—Ü–µ–Ω—Å–∫', '–ë–æ–ª—Ö–æ–≤'] },
            58: { name: '–ü–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ü–µ–Ω–∑–∞', '–ö—É–∑–Ω–µ—Ü–∫', '–ó–∞—Ä–µ—á–Ω—ã–π', '–ö–∞–º–µ–Ω–∫–∞', '–°–µ—Ä–¥–æ–±—Å–∫'] },
            59: { name: '–ü–µ—Ä–º—Å–∫–∏–π –∫—Ä–∞–π', cities: ['–ü–µ—Ä–º—å', '–ë–µ—Ä–µ–∑–Ω–∏–∫–∏', '–°–æ–ª–∏–∫–∞–º—Å–∫', '–ß–∞–π–∫–æ–≤—Å–∫–∏–π', '–õ—ã—Å—å–≤–∞', '–ö—É–Ω–≥—É—Ä', '–ö—Ä–∞—Å–Ω–æ–∫–∞–º—Å–∫'] },
            60: { name: '–ü—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ü—Å–∫–æ–≤', '–í–µ–ª–∏–∫–∏–µ –õ—É–∫–∏', '–û—Å—Ç—Ä–æ–≤', '–ù–µ–≤–µ–ª—å', '–û–ø–æ—á–∫–∞'] },
            61: { name: '–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É', '–¢–∞–≥–∞–Ω—Ä–æ–≥', '–®–∞—Ö—Ç—ã', '–í–æ–ª–≥–æ–¥–æ–Ω—Å–∫', '–ù–æ–≤–æ—á–µ—Ä–∫–∞—Å—Å–∫', '–ë–∞—Ç–∞–π—Å–∫', '–ù–æ–≤–æ—à–∞—Ö—Ç–∏–Ω—Å–∫', '–ö–∞–º–µ–Ω—Å–∫-–®–∞—Ö—Ç–∏–Ω—Å–∫–∏–π'] },
            62: { name: '–†—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–†—è–∑–∞–Ω—å', '–ö–∞—Å–∏–º–æ–≤', '–°–∫–æ–ø–∏–Ω', '–°–∞—Å–æ–≤–æ', '–†—è–∂—Å–∫'] },
            63: { name: '–°–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–°–∞–º–∞—Ä–∞', '–¢–æ–ª—å—è—Ç—Ç–∏', '–°—ã–∑—Ä–∞–Ω—å', '–ù–æ–≤–æ–∫—É–π–±—ã—à–µ–≤—Å–∫', '–ß–∞–ø–∞–µ–≤—Å–∫', '–ñ–∏–≥—É–ª—ë–≤—Å–∫', '–û—Ç—Ä–∞–¥–Ω—ã–π'] },
            64: { name: '–°–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–°–∞—Ä–∞—Ç–æ–≤', '–≠–Ω–≥–µ–ª—å—Å', '–ë–∞–ª–∞–∫–æ–≤–æ', '–ë–∞–ª–∞—à–æ–≤', '–í–æ–ª—å—Å–∫', '–ü—É–≥–∞—á—ë–≤'] },
            65: { name: '–°–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–Æ–∂–Ω–æ-–°–∞—Ö–∞–ª–∏–Ω—Å–∫', '–ö–æ—Ä—Å–∞–∫–æ–≤', '–•–æ–ª–º—Å–∫', '–û—Ö–∞', '–ü–æ—Ä–æ–Ω–∞–π—Å–∫'] },
            66: { name: '–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥', '–ù–∏–∂–Ω–∏–π –¢–∞–≥–∏–ª', '–ö–∞–º–µ–Ω—Å–∫-–£—Ä–∞–ª—å—Å–∫–∏–π', '–ü–µ—Ä–≤–æ—É—Ä–∞–ª—å—Å–∫', '–°–µ—Ä–æ–≤', '–ê—Å–±–µ—Å—Ç', '–ù–æ–≤–æ—É—Ä–∞–ª—å—Å–∫', '–ü–æ–ª–µ–≤—Å–∫–æ–π', '–ö—Ä–∞—Å–Ω–æ—Ç—É—Ä—å–∏–Ω—Å–∫', '–†–µ–≤–¥–∞', '–í–µ—Ä—Ö–Ω—è—è –ü—ã—à–º–∞', '–õ–µ—Å–Ω–æ–π', '–ö–∞—á–∫–∞–Ω–∞—Ä', '–ê–ª–∞–ø–∞–µ–≤—Å–∫', '–ë–µ—Ä—ë–∑–æ–≤—Å–∫–∏–π'] },
            67: { name: '–°–º–æ–ª–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–°–º–æ–ª–µ–Ω—Å–∫', '–í—è–∑—å–º–∞', '–†–æ—Å–ª–∞–≤–ª—å', '–Ø—Ä—Ü–µ–≤–æ', '–°–∞—Ñ–æ–Ω–æ–≤–æ', '–î–µ—Å–Ω–æ–≥–æ—Ä—Å–∫'] },
            68: { name: '–¢–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–¢–∞–º–±–æ–≤', '–ú–∏—á—É—Ä–∏–Ω—Å–∫', '–†–∞—Å—Å–∫–∞–∑–æ–≤–æ', '–ú–æ—Ä—à–∞–Ω—Å–∫', '–ö–æ—Ç–æ–≤—Å–∫'] },
            69: { name: '–¢–≤–µ—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–¢–≤–µ—Ä—å', '–†–∂–µ–≤', '–í—ã—à–Ω–∏–π –í–æ–ª–æ—á—ë–∫', '–ö–∏–º—Ä—ã', '–¢–æ—Ä–∂–æ–∫', '–ö–æ–Ω–∞–∫–æ–≤–æ', '–£–¥–æ–º–ª—è'] },
            70: { name: '–¢–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–¢–æ–º—Å–∫', '–°–µ–≤–µ—Ä—Å–∫', '–°—Ç—Ä–µ–∂–µ–≤–æ–π', '–ê—Å–∏–Ω–æ', '–ö–æ–ª–ø–∞—à–µ–≤–æ'] },
            71: { name: '–¢—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–¢—É–ª–∞', '–ù–æ–≤–æ–º–æ—Å–∫–æ–≤—Å–∫', '–î–æ–Ω—Å–∫–æ–π', '–ê–ª–µ–∫—Å–∏–Ω', '–©—ë–∫–∏–Ω–æ', '–£–∑–ª–æ–≤–∞—è', '–ï—Ñ—Ä–µ–º–æ–≤'] },
            72: { name: '–¢—é–º–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–¢—é–º–µ–Ω—å', '–¢–æ–±–æ–ª—å—Å–∫', '–ò—à–∏–º', '–Ø–ª—É—Ç–æ—Ä–æ–≤—Å–∫', '–ó–∞–≤–æ–¥–æ—É–∫–æ–≤—Å–∫'] },
            73: { name: '–£–ª—å—è–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–£–ª—å—è–Ω–æ–≤—Å–∫', '–î–∏–º–∏—Ç—Ä–æ–≤–≥—Ä–∞–¥', '–ò–Ω–∑–∞', '–ë–∞—Ä—ã—à', '–ù–æ–≤–æ—É–ª—å—è–Ω–æ–≤—Å–∫'] },
            74: { name: '–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ß–µ–ª—è–±–∏–Ω—Å–∫', '–ú–∞–≥–Ω–∏—Ç–æ–≥–æ—Ä—Å–∫', '–ó–ª–∞—Ç–æ—É—Å—Ç', '–ú–∏–∞—Å—Å', '–ö–æ–ø–µ–π—Å–∫', '–û–∑—ë—Ä—Å–∫', '–¢—Ä–æ–∏—Ü–∫', '–°–Ω–µ–∂–∏–Ω—Å–∫', '–°–∞—Ç–∫–∞', '–ß–µ–±–∞—Ä–∫—É–ª—å', '–ö—ã—à—Ç—ã–º', '–Æ–∂–Ω–æ—É—Ä–∞–ª—å—Å–∫', '–ö–æ—Ä–∫–∏–Ω–æ', '–¢—Ä—ë—Ö–≥–æ—Ä–Ω—ã–π', '–ê—à–∞'] },
            75: { name: '–ó–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π –∫—Ä–∞–π', cities: ['–ß–∏—Ç–∞', '–ö—Ä–∞—Å–Ω–æ–∫–∞–º–µ–Ω—Å–∫', '–ë–æ—Ä–∑—è', '–ù–µ—Ä—á–∏–Ω—Å–∫', '–ü–µ—Ç—Ä–æ–≤—Å–∫-–ó–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π'] },
            76: { name: '–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–Ø—Ä–æ—Å–ª–∞–≤–ª—å', '–†—ã–±–∏–Ω—Å–∫', '–ü–µ—Ä–µ—Å–ª–∞–≤–ª—å-–ó–∞–ª–µ—Å—Å–∫–∏–π', '–¢—É—Ç–∞–µ–≤', '–£–≥–ª–∏—á', '–†–æ—Å—Ç–æ–≤'] },
            77: { name: '–ú–æ—Å–∫–≤–∞', cities: ['–ú–æ—Å–∫–≤–∞'] },
            78: { name: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', cities: ['–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥'] },
            79: { name: '–ï–≤—Ä–µ–π—Å–∫–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è –æ–±–ª–∞—Å—Ç—å', cities: ['–ë–∏—Ä–æ–±–∏–¥–∂–∞–Ω', '–û–±–ª—É—á—å–µ'] },
            83: { name: '–ù–µ–Ω–µ—Ü–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥', cities: ['–ù–∞—Ä—å—è–Ω-–ú–∞—Ä'] },
            86: { name: '–•–∞–Ω—Ç—ã-–ú–∞–Ω—Å–∏–π—Å–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥', cities: ['–•–∞–Ω—Ç—ã-–ú–∞–Ω—Å–∏–π—Å–∫', '–°—É—Ä–≥—É—Ç', '–ù–∏–∂–Ω–µ–≤–∞—Ä—Ç–æ–≤—Å–∫', '–ù–µ—Ñ—Ç–µ—é–≥–∞–Ω—Å–∫', '–ö–æ–≥–∞–ª—ã–º', '–ù—è–≥–∞–Ω—å', '–ú–µ–≥–∏–æ–Ω', '–õ–∞–Ω–≥–µ–ø–∞—Å', '–ü—ã—Ç—å-–Ø—Ö', '–£—Ä–∞–π', '–Æ–≥–æ—Ä—Å–∫', '–†–∞–¥—É–∂–Ω—ã–π', '–ü–æ–∫–∞—á–∏', '–õ—è–Ω—Ç–æ—Ä'] },
            87: { name: '–ß—É–∫–æ—Ç—Å–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥', cities: ['–ê–Ω–∞–¥—ã—Ä—å', '–ë–∏–ª–∏–±–∏–Ω–æ', '–ü–µ–≤–µ–∫'] },
            89: { name: '–Ø–º–∞–ª–æ-–ù–µ–Ω–µ—Ü–∫–∏–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –æ–∫—Ä—É–≥', cities: ['–°–∞–ª–µ—Ö–∞—Ä–¥', '–ù–æ–≤—ã–π –£—Ä–µ–Ω–≥–æ–π', '–ù–æ—è–±—Ä—å—Å–∫', '–ù–∞–¥—ã–º', '–ú—É—Ä–∞–≤–ª–µ–Ω–∫–æ', '–ì—É–±–∫–∏–Ω—Å–∫–∏–π', '–õ–∞–±—ã—Ç–Ω–∞–Ω–≥–∏', '–¢–∞—Ä–∫–æ-–°–∞–ª–µ'] },
            91: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö—Ä—ã–º', cities: ['–°–∏–º—Ñ–µ—Ä–æ–ø–æ–ª—å', '–ö–µ—Ä—á—å', '–ï–≤–ø–∞—Ç–æ—Ä–∏—è', '–Ø–ª—Ç–∞', '–§–µ–æ–¥–æ—Å–∏—è', '–î–∂–∞–Ω–∫–æ–π', '–ê–ª—É—à—Ç–∞', '–ë–∞—Ö—á–∏—Å–∞—Ä–∞–π', '–ö—Ä–∞—Å–Ω–æ–ø–µ—Ä–µ–∫–æ–ø—Å–∫', '–°–∞–∫–∏', '–ê—Ä–º—è–Ω—Å–∫', '–°—É–¥–∞–∫', '–ë–µ–ª–æ–≥–æ—Ä—Å–∫'] },
            92: { name: '–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å', cities: ['–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å'] },
            93: { name: '–†–µ—Å–ø—É–±–ª–∏–∫–∞ –ö—Ä—ã–º (–∞–ª—å—Ç.)', cities: ['–°–∏–º—Ñ–µ—Ä–æ–ø–æ–ª—å', '–ö–µ—Ä—á—å', '–ï–≤–ø–∞—Ç–æ—Ä–∏—è', '–Ø–ª—Ç–∞', '–§–µ–æ–¥–æ—Å–∏—è'] },
            94: { name: '–ë–∞–π–∫–æ–Ω—É—Ä', cities: ['–ë–∞–π–∫–æ–Ω—É—Ä'] },
            95: { name: '–ß–µ—á–µ–Ω—Å–∫–∞—è –†–µ—Å–ø—É–±–ª–∏–∫–∞ (–∞–ª—å—Ç.)', cities: ['–ì—Ä–æ–∑–Ω—ã–π', '–£—Ä—É—Å-–ú–∞—Ä—Ç–∞–Ω', '–®–∞–ª–∏', '–ì—É–¥–µ—Ä–º–µ—Å', '–ê—Ä–≥—É–Ω'] }
        };
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ —Ä–µ–≥–∏–æ–Ω–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        document.getElementById('regionInput').addEventListener('input', function() {
            const regionCode = parseInt(this.value);
            const citySelect = document.getElementById('cityInput');
            const cityHint = document.getElementById('cityHint');
            
            citySelect.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ --</option>';
            cityValid = false;
            selectedCity = '';
            
            if (REGIONS_DATA[regionCode]) {
                citySelect.disabled = false;
                cityHint.textContent = `‚úì ${REGIONS_DATA[regionCode].name}`;
                cityHint.className = 'field-hint success';
                
                const cities = REGIONS_DATA[regionCode].cities.sort();
                cities.forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
            } else if (this.value) {
                citySelect.innerHTML = '<option value="">-- –†–µ–≥–∏–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω --</option>';
                citySelect.disabled = true;
                cityHint.textContent = '‚úó –†–µ–≥–∏–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω';
                cityHint.className = 'field-hint error';
            } else {
                citySelect.innerHTML = '<option value="">-- –°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω --</option>';
                citySelect.disabled = true;
                cityHint.textContent = '';
                cityHint.className = 'field-hint';
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞
        document.getElementById('cityInput').addEventListener('change', function() {
            const cityHint = document.getElementById('cityHint');
            const inputCity = this.value;
            const regionCode = parseInt(document.getElementById('regionInput').value);
            
            if (!inputCity) {
                if (REGIONS_DATA[regionCode]) {
                    cityHint.textContent = `‚úì ${REGIONS_DATA[regionCode].name}`;
                    cityHint.className = 'field-hint success';
                } else {
                    cityHint.textContent = '';
                    cityHint.className = 'field-hint';
                }
                cityValid = false;
                selectedCity = '';
                return;
            }
            
            cityHint.textContent = `‚úì ${inputCity}, ${REGIONS_DATA[regionCode].name}`;
            cityHint.className = 'field-hint success';
            cityValid = true;
            selectedCity = inputCity;
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–≤–æ–¥–∞ —à–∫–æ–ª—ã
        document.getElementById('schoolInput').addEventListener('input', function() {
            const schoolHint = document.getElementById('schoolHint');
            const inputSchool = this.value.trim();
            
            if (!inputSchool) {
                schoolHint.textContent = '';
                schoolHint.className = 'field-hint';
                schoolValid = false;
                selectedSchool = '';
                return;
            }
            
            if (!cityValid || !selectedCity) {
                schoolHint.textContent = '–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥';
                schoolHint.className = 'field-hint info';
                schoolValid = false;
                selectedSchool = '';
                return;
            }
            
            schoolHint.textContent = `‚úì –®–∫–æ–ª–∞ ‚Ññ${inputSchool}`;
            schoolHint.className = 'field-hint success';
            schoolValid = true;
            selectedSchool = inputSchool;
        });
        
        // –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è
        function loadSavedPassword() {
            const savedPassword = localStorage.getItem('teacherAccessKey');
            if (savedPassword) {
                document.getElementById('teacherKey').value = savedPassword;
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –≤ localStorage
        function savePassword(password) {
            if (password) {
                localStorage.setItem('teacherAccessKey', password);
            }
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        loadSavedPassword();
        
        document.getElementById('authForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const cityInput = document.getElementById('cityInput').value;
            const schoolInput = document.getElementById('schoolInput').value.trim();
            const key = document.getElementById('teacherKey').value.trim();
            const errorMessage = document.getElementById('errorMessage');
            
            if (!cityInput) {
                showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥');
                return;
            }
            
            if (!schoolInput) {
                showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —à–∫–æ–ª—ã');
                return;
            }
            
            if (!schoolValid) {
                showError(`–î–∞–Ω–Ω—ã–µ –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –¥–ª—è —à–∫–æ–ª—ã ‚Ññ${schoolInput} –≤ –≥. ${selectedCity}`);
                return;
            }
            
            if (!key) {
                showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞');
                return;
            }
            
            try {
                const response = await fetch('/api/verify-key', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ key, city: selectedCity, school: selectedSchool })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP –æ—à–∏–±–∫–∞: ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    errorMessage.style.display = 'none';
                    allData = result.data;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–∞—Ä–æ–ª—å –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                    savePassword(key);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–¥–∞–∂–µ –µ—Å–ª–∏ –ø—É—Å—Ç—ã–µ)
                    showResults(result.data);
                    
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                    startAutoRefresh();
                } else {
                    showError(result.message || '–ù–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞');
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                if (error.message.includes('Failed to fetch')) {
                    showError('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω.');
                } else {
                    showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö: ' + error.message);
                }
            }
        });
        
        function showError(message) {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
        }
        
        function showResults(data) {
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ—Ä–æ–¥ –∏ —à–∫–æ–ª—É
            document.getElementById('selectedLocation').innerHTML = `
                <h3>${escapeHtml(selectedCity)} ‚Äî <span>–®–∫–æ–ª–∞ ‚Ññ${escapeHtml(selectedSchool)}</span></h3>
            `;
            
            const classesContainer = document.getElementById('classesContainer');
            const statsBar = document.getElementById('statsBar');
            
            // –ü–æ–¥—Å—á—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            let totalStudents = 0;
            let totalClasses = Object.keys(data).length;
            let totalCorrect = 0;
            let totalQuestions = 0;
            
            for (const className in data) {
                // –ü–æ–¥—Å—á—ë—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —É—á–µ–Ω–∏–∫–æ–≤
                const uniqueKeys = new Set();
                data[className].forEach(student => {
                    const key = `${student.first_name.toLowerCase()}_${student.last_name.toLowerCase()}`;
                    uniqueKeys.add(key);
                    totalCorrect += student.score;
                    totalQuestions += student.max_score;
                });
                totalStudents += uniqueKeys.size;
            }
            
            const avgPercent = totalQuestions > 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            statsBar.innerHTML = `
                <div class="stat-item">
                    <div class="stat-number">${totalClasses}</div>
                    <div class="stat-label">–ö–ª–∞—Å—Å–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${totalStudents}</div>
                    <div class="stat-label">–£—á–µ–Ω–∏–∫–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${avgPercent}%</div>
                    <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</div>
                </div>
            `;
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –∫–ª–∞—Å—Å–∞–º
            if (totalClasses === 0) {
                classesContainer.innerHTML = '<div class="no-results">–ü–æ–∫–∞ —á—Ç–æ –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</div>';
                document.getElementById('globalStatsSection').style.display = 'none';
                return;
            }
            
            let html = '';
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤
            const sortedClasses = Object.keys(data).sort((a, b) => {
                const numA = parseInt(a.replace(/\D/g, '')) || 0;
                const numB = parseInt(b.replace(/\D/g, '')) || 0;
                if (numA !== numB) return numA - numB;
                return a.localeCompare(b);
            });
            
            sortedClasses.forEach((className, classIndex) => {
                const students = data[className];
                
                // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—á–µ–Ω–∏–∫–æ–≤ –ø–æ –∏–º–µ–Ω–∏ –∏ —Ñ–∞–º–∏–ª–∏–∏
                const groupedStudents = {};
                students.forEach(student => {
                    const key = `${student.first_name.toLowerCase()}_${student.last_name.toLowerCase()}`;
                    if (!groupedStudents[key]) {
                        groupedStudents[key] = {
                            first_name: student.first_name,
                            last_name: student.last_name,
                            tests: []
                        };
                    }
                    groupedStudents[key].tests.push({
                        level: student.level,
                        score: student.score,
                        max_score: student.max_score,
                        answers: student.answers,
                        time_spent: student.time_spent || 0
                    });
                });
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–µ—Å—Ç—ã –∫–∞–∂–¥–æ–≥–æ —É—á–µ–Ω–∏–∫–∞ –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                for (const key in groupedStudents) {
                    groupedStudents[key].tests = sortLevelsByDifficulty(
                        groupedStudents[key].tests.map(t => t.level)
                    ).map(level => {
                        return groupedStudents[key].tests.find(t => t.level === level);
                    });
                }
                
                const uniqueStudents = Object.values(groupedStudents);
                
                html += `
                    <div class="class-card" style="animation-delay: ${classIndex * 0.1}s">
                        <div class="class-header">
                            <div class="class-name">–ö–ª–∞—Å—Å ${escapeHtml(className)}</div>
                            <div class="student-count">—Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–æ: ${uniqueStudents.length} ${getStudentWord(uniqueStudents.length)}</div>
                        </div>
                        <table class="results-table">
                            <thead>
                                <tr>
                                    <th>–ò–º—è</th>
                                    <th>–§–∞–º–∏–ª–∏—è</th>
                                    <th>–£—Ä–æ–≤–µ–Ω—å</th>
                                    <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                                    <th>–í—Ä–µ–º—è</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                uniqueStudents.forEach((student, studentIndex) => {
                    const studentId = `student-${classIndex}-${studentIndex}`;
                    
                    // –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É —É—Ä–æ–≤–Ω–µ–π –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                    const levelNames = student.tests.map(t => getLevelName(t.level)).join(' / ');
                    const results = student.tests.map(t => Math.round((t.score / t.max_score) * 100) + '%').join(' / ');
                    const times = student.tests.map(t => formatTime(t.time_spent)).join(' / ');
                    
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–±—â–∏–π –∫–ª–∞—Å—Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (–ø–æ —Å—Ä–µ–¥–Ω–µ–º—É)
                    const totalScore = student.tests.reduce((sum, t) => sum + t.score, 0);
                    const totalMax = student.tests.reduce((sum, t) => sum + t.max_score, 0);
                    const scoreClass = getScoreClass(totalScore, totalMax);
                    
                    html += `
                        <tr class="student-row" onclick="toggleDetails('${studentId}')" id="row-${studentId}">
                            <td>${escapeHtml(student.first_name)} <span class="expand-icon">‚ñº</span></td>
                            <td>${escapeHtml(student.last_name)}</td>
                            <td><span class="level-badge">${levelNames}</span></td>
                            <td><span class="score-badge ${scoreClass}">${results}</span></td>
                            <td><span class="time-badge">${times}</span></td>
                        </tr>
                    `;
                    
                    // –î–µ—Ç–∞–ª–∏ —É—á–µ–Ω–∏–∫–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ —Ç–µ—Å—Ç—ã
                    html += `
                        <tr>
                            <td colspan="5" style="padding: 0; border: none;">
                                <div class="student-details" id="${studentId}">
                    `;
                    
                    // –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏
                    student.tests.forEach((test, testIndex) => {
                        const levelName = getLevelName(test.level);
                        const percent = Math.round((test.score / test.max_score) * 100);
                        const timeStr = formatTime(test.time_spent);
                        
                        html += `
                            <div class="test-section">
                                <div class="test-header">
                                    üìù –¢–µ—Å—Ç: <strong>${levelName}</strong> ‚Äî ${test.score}/${test.max_score} (${percent}%) | ‚è±Ô∏è ${timeStr}
                                </div>
                                <div class="answers-list">
                        `;
                        
                        if (test.answers && Array.isArray(test.answers)) {
                            test.answers.forEach((answerObj, i) => {
                                const isCorrect = answerObj.correct;
                                const blockClass = isCorrect ? 'correct-block' : 'incorrect-block';
                                const icon = isCorrect ? '‚úÖ' : '‚ùå';
                                const userAnswer = answerObj.answer ? answerObj.answer.toUpperCase() : '‚Äî';
                                const correctAnswer = answerObj.correct_answer ? answerObj.correct_answer.toUpperCase() : '';
                                const questionText = getQuestionText(test.level, i + 1);
                                
                                html += `
                                    <div class="question-block ${blockClass}">
                                        <div class="question-header">
                                            <span class="question-icon">${icon}</span>
                                            <div class="question-content">
                                                <div class="question-title">–í–æ–ø—Ä–æ—Å ${i + 1}</div>
                                                <div class="question-text-full">${escapeHtml(questionText)}</div>
                                                <div class="answer-info">
                                                    ${isCorrect ? `
                                                        <span class="answer-label correct-answer">–û—Ç–≤–µ—Ç: ${userAnswer} ‚úì</span>
                                                    ` : `
                                                        <span class="answer-label wrong-answer">–û—Ç–≤–µ—Ç —É—á–µ–Ω–∏–∫–∞: ${userAnswer}</span>
                                                        <span class="answer-label correct-answer">–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}</span>
                                                    `}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            });
                        } else {
                            html += '<div style="color: #8892b0;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –æ—Ç–≤–µ—Ç–∞—Ö</div>';
                        }
                        
                        html += `
                                </div>
                            </div>
                        `;
                    });
                    
                    html += `
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                        <div class="click-hint">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–æ–∫—É —É—á–µ–Ω–∏–∫–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏</div>
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –∫–ª–∞—Å—Å–∞
                html += generateClassStats(students, className);
                
                html += `
                    </div>
                `;
            });
            
            classesContainer.innerHTML = html;
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            showGlobalStats(data);
        }
        
        function generateClassStats(students, className) {
            let questionStats = {};
            
            // –°–æ–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–ª–∞—Å—Å—É
            students.forEach(student => {
                const level = student.level;
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º
                if (!questionStats[level]) {
                    questionStats[level] = {};
                }
                
                if (student.answers && Array.isArray(student.answers)) {
                    student.answers.forEach((answerObj, i) => {
                        const qNum = i + 1;
                        if (!questionStats[level][qNum]) {
                            questionStats[level][qNum] = { correct: 0, incorrect: 0, total: 0 };
                        }
                        questionStats[level][qNum].total++;
                        if (answerObj.correct) {
                            questionStats[level][qNum].correct++;
                        } else {
                            questionStats[level][qNum].incorrect++;
                        }
                    });
                }
            });
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            if (Object.keys(questionStats).length === 0) {
                return '';
            }
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —É—Ä–æ–≤–Ω–µ–π –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–ª—ë–≥–∫–∏–π -> —Å—Ä–µ–¥–Ω–∏–π -> —Ç—è–∂—ë–ª—ã–π)
            const sortedLevels = sortLevelsByDifficulty(Object.keys(questionStats));
            
            const statsId = `class-stats-${className.replace(/\s/g, '-')}`;
            
            let html = `
                <div class="class-stats-section collapsed" id="${statsId}">
                    <div class="class-stats-header" onclick="toggleClassStats('${statsId}')">
                        <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–ª–∞—Å—Å–∞ ${escapeHtml(className)} <span class="class-stats-toggle">‚ñº</span></h3>
                    </div>
                    
                    <div class="class-stats-content">
                        <div class="class-questions-stats">
                            <div class="class-stats-title">üìù –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º</div>
            `;
            
            sortedLevels.forEach(level => {
                const levelName = getLevelName(level);
                const qStats = questionStats[level];
                
                if (!qStats || Object.keys(qStats).length === 0) return;
                
                html += `
                    <div class="test-level-group class-test-group">
                        <div class="test-level-title">${levelName}</div>
                `;
                
                // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –Ω–æ–º–µ—Ä—É
                const sortedQuestions = Object.keys(qStats).sort((a, b) => parseInt(a) - parseInt(b));
                
                sortedQuestions.forEach(qNum => {
                    const stat = qStats[qNum];
                    const correctPercent = stat.total > 0 ? Math.round((stat.correct / stat.total) * 100) : 0;
                    const incorrectPercent = 100 - correctPercent;
                    const questionText = getQuestionText(level, parseInt(qNum));
                    
                    html += `
                        <div class="question-stat-item class-question-stat">
                            <div class="question-stat-header">
                                <div class="question-stat-text">
                                    <span class="question-stat-number">–í–æ–ø—Ä–æ—Å ${qNum}:</span>
                                    ${escapeHtml(questionText)}
                                </div>
                                <div class="question-stat-respondents">${stat.total} –æ—Ç–≤.</div>
                            </div>
                            <div class="question-stat-bar-container">
                                <div class="question-stat-bar">
                                    ${correctPercent > 0 ? `<div class="question-stat-bar-correct" style="width: ${correctPercent}%">${correctPercent}%</div>` : ''}
                                    ${incorrectPercent > 0 ? `<div class="question-stat-bar-incorrect">${incorrectPercent}%</div>` : ''}
                                </div>
                            </div>
                            <div class="question-stat-legend">
                                <div class="legend-item">
                                    <span class="legend-dot correct"></span>
                                    <span class="legend-text">–ü—Ä–∞–≤–∏–ª—å–Ω–æ: ${stat.correct}</span>
                                </div>
                                <div class="legend-item">
                                    <span class="legend-dot incorrect"></span>
                                    <span class="legend-text">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ: ${stat.incorrect}</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
            });
            
            html += '</div></div></div>';
            
            return html;
        }
        
        function toggleClassStats(statsId) {
            const section = document.getElementById(statsId);
            if (section) {
                section.classList.toggle('collapsed');
            }
        }
        
        function showGlobalStats(data) {
            const section = document.getElementById('globalStatsSection');
            
            let totalCorrect = 0;
            let totalQuestions = 0;
            let totalResults = 0;
            let excellentCount = 0;
            let goodCount = 0;
            let averageCount = 0;
            let poorCount = 0;
            
            for (const className in data) {
                data[className].forEach(student => {
                    totalCorrect += student.score;
                    totalQuestions += student.max_score;
                    totalResults++;
                    
                    const percent = (student.score / student.max_score) * 100;
                    if (percent >= 90) excellentCount++;
                    else if (percent >= 70) goodCount++;
                    else if (percent >= 50) averageCount++;
                    else poorCount++;
                });
            }
            
            const avgPercent = totalQuestions > 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;
            const avgClass = avgPercent >= 90 ? 'excellent' : avgPercent >= 70 ? 'good' : avgPercent >= 50 ? 'average' : 'poor';
            
            let html = `
                <div class="global-stats-header">
                    <h2>–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º</h2>
                </div>
                
                <div class="stats-grid">
                    <div class="stats-card">
                        <div class="stats-card-value ${avgClass}">${avgPercent}%</div>
                        <div class="stats-card-label">–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-card-value neutral">${totalCorrect}/${totalQuestions}</div>
                        <div class="stats-card-label">–í—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-card-value excellent">${excellentCount}</div>
                        <div class="stats-card-label">–û—Ç–ª–∏—á–Ω–æ (90%+)</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-card-value good">${goodCount}</div>
                        <div class="stats-card-label">–•–æ—Ä–æ—à–æ (70-89%)</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-card-value average">${averageCount}</div>
                        <div class="stats-card-label">–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ (50-69%)</div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-card-value poor">${poorCount}</div>
                        <div class="stats-card-label">–ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ (<50%)</div>
                    </div>
                </div>
                
                <div class="global-stats-hint">
                    <p>üìä –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞</p>
                </div>
            `;
            
            section.innerHTML = html;
            section.style.display = 'block';
        }
        
        function toggleDetails(studentId) {
            const details = document.getElementById(studentId);
            const row = document.getElementById('row-' + studentId);
            
            if (details.classList.contains('visible')) {
                details.classList.remove('visible');
                row.classList.remove('expanded');
            } else {
                // –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –¥—Ä—É–≥–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–µ—Ç–∞–ª–∏
                document.querySelectorAll('.student-details.visible').forEach(el => {
                    el.classList.remove('visible');
                });
                document.querySelectorAll('.student-row.expanded').forEach(el => {
                    el.classList.remove('expanded');
                });
                
                details.classList.add('visible');
                row.classList.add('expanded');
            }
        }
        
        function getScoreClass(score, maxScore) {
            const percent = (score / maxScore) * 100;
            if (percent >= 90) return 'score-excellent';
            if (percent >= 70) return 'score-good';
            if (percent >= 50) return 'score-average';
            return 'score-poor';
        }
        
        function getLevelName(level, short = true) {
            const difficultyRu = {
                'easy': '–ª—ë–≥–∫–∏–π',
                'medium': '—Å—Ä–µ–¥–Ω–∏–π',
                'hard': '—Ç—è–∂—ë–ª—ã–π'
            };
            
            // –ü–æ–ø—ã—Ç–∫–∞ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å
            const match = level.match(/^(\d+)_(\w+)$/);
            if (match) {
                const difficulty = match[2];
                return difficultyRu[difficulty] || difficulty;
            }
            
            return level;
        }
        
        // –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        function getDifficultyOrder(level) {
            const match = level.match(/^(\d+)_(\w+)$/);
            if (match) {
                const difficulty = match[2];
                const order = { 'easy': 1, 'medium': 2, 'hard': 3 };
                return order[difficulty] || 99;
            }
            return 99;
        }
        
        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —É—Ä–æ–≤–Ω–µ–π –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        function sortLevelsByDifficulty(levels) {
            return levels.sort((a, b) => getDifficultyOrder(a) - getDifficultyOrder(b));
        }
        
        function getQuestionWord(count) {
            const lastDigit = count % 10;
            const lastTwoDigits = count % 100;
            
            if (lastTwoDigits >= 11 && lastTwoDigits <= 19) {
                return '–≤–æ–ø—Ä–æ—Å–æ–≤';
            }
            
            if (lastDigit === 1) {
                return '–≤–æ–ø—Ä–æ—Å';
            }
            
            if (lastDigit >= 2 && lastDigit <= 4) {
                return '–≤–æ–ø—Ä–æ—Å–∞';
            }
            
            return '–≤–æ–ø—Ä–æ—Å–æ–≤';
        }
        
        function getStudentWord(count) {
            const lastDigit = count % 10;
            const lastTwoDigits = count % 100;
            
            if (lastTwoDigits >= 11 && lastTwoDigits <= 19) {
                return '—É—á–µ–Ω–∏–∫–æ–≤';
            }
            
            if (lastDigit === 1) {
                return '—É—á–µ–Ω–∏–∫';
            }
            
            if (lastDigit >= 2 && lastDigit <= 4) {
                return '—É—á–µ–Ω–∏–∫–∞';
            }
            
            return '—É—á–µ–Ω–∏–∫–æ–≤';
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function logout() {
            document.getElementById('authSection').style.display = 'block';
            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('teacherKey').value = '';
            document.getElementById('classesContainer').innerHTML = '';
            document.getElementById('statsBar').innerHTML = '';
            document.getElementById('globalStatsSection').innerHTML = '';
            allData = null;
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
            stopAutoRefresh();
        }
        
        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        let autoRefreshInterval = null;
        const AUTO_REFRESH_DELAY = 10000; // 10 —Å–µ–∫—É–Ω–¥
        
        function startAutoRefresh() {
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –µ—Å–ª–∏ –µ—Å—Ç—å
            stopAutoRefresh();
            
            autoRefreshInterval = setInterval(async () => {
                await refreshResults();
            }, AUTO_REFRESH_DELAY);
            
            console.log('–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ (–∫–∞–∂–¥—ã–µ 10 —Å–µ–∫)');
        }
        
        function stopAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
                console.log('–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
            }
        }
        
        async function refreshResults() {
            if (!selectedCity || !selectedSchool) return;
            
            try {
                const key = document.getElementById('teacherKey').value.trim() || localStorage.getItem('teacherAccessKey');
                
                const response = await fetch('/api/verify-key', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ key, city: selectedCity, school: selectedSchool })
                });
                
                if (!response.ok) return;
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –ª–∏ –¥–∞–Ω–Ω—ã–µ
                    const newDataStr = JSON.stringify(result.data);
                    const oldDataStr = JSON.stringify(allData);
                    
                    if (newDataStr !== oldDataStr) {
                        console.log('–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ–±–Ω–æ–≤–ª—è–µ–º...');
                        allData = result.data;
                        showResults(result.data);
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                        showUpdateNotification();
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:', error);
            }
        }
        
        async function manualRefresh() {
            const btn = document.getElementById('refreshBtn');
            btn.disabled = true;
            btn.innerHTML = '<span>‚è≥</span> –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...';
            
            await refreshResults();
            
            btn.disabled = false;
            btn.innerHTML = '<span>üîÑ</span> –û–±–Ω–æ–≤–∏—Ç—å';
        }
        
        function showUpdateNotification() {
            // –°–æ–∑–¥–∞—ë–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –µ—Å–ª–∏ –µ–≥–æ –µ—â—ë –Ω–µ—Ç
            let notification = document.getElementById('updateNotification');
            if (!notification) {
                notification = document.createElement('div');
                notification.id = 'updateNotification';
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: linear-gradient(135deg, #27ae60, #2ecc71);
                    color: white;
                    padding: 15px 25px;
                    border-radius: 10px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    z-index: 9999;
                    animation: slideIn 0.3s ease-out;
                    font-weight: 600;
                `;
                document.body.appendChild(notification);
            }
            
            notification.innerHTML = '‚ú® –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!';
            notification.style.display = 'block';
            
            // –°–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>
